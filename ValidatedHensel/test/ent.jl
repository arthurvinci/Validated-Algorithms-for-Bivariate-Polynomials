using AbstractAlgebra
using Nemo
using ValidatedHensel


l = 10

QX, _ = power_series_ring(AbstractAlgebra.QQ, l, "x"; model=:capped_absolute)
QXY, _ = polynomial_ring(QX,"y")
RX, x = power_series_ring(RDF, l, "x"; model=:capped_absolute)
RXY, y = polynomial_ring(RX,"y")

F = (0.5555555555555556*x^3 + 1.75*x^4 + 0.1*x^5 + 3.0*x^6 + 1.5*x^7 + 2.0*x^8 + 1.2*x^9 + O(x^10))*y^40 + (1.1111111111111112*x^3 + 3.5*x^4 + 0.2*x^5 + 6.0*x^6 + 3.0*x^7 + 4.0*x^8 + 2.4*x^9 + O(x^10))*y^39 + (0.05555555555555555*x^3 + 0.175*x^4 + 0.01*x^5 + 0.3*x^6 + 0.8444444444444444*x^7 + 3.359722222222222*x^8 + 3.3075*x^9 + O(x^10))*y^38 + (0.5555555555555556*x^3 + 1.75*x^4 + 0.1*x^5 + 3.0*x^6 + 1.5*x^7 + 2.0*x^8 + 1.2*x^9 + O(x^10))*y^37 + (0.1111111111111111*x^3 + 0.35*x^4 + 0.02*x^5 + 1.2481481481481482*x^6 + 2.55*x^7 + 1.4506944444444445*x^8 + 9.6525*x^9 + O(x^10))*y^35 + (2.2222222222222223*x^3 + 7.0*x^4 + 0.4*x^5 + 12.0*x^6 + 6.0*x^7 + 8.0*x^8 + 4.8*x^9 + O(x^10))*y^34 + (0.5555555555555556*x^3 + 1.75*x^4 + 0.1*x^5 + 3.0*x^6 + 1.5*x^7 + 2.0*x^8 + 1.2*x^9 + O(x^10))*y^33 + (1.2962962962962963*x^3 + 6.861111111111111*x^4 + 9.372222222222222*x^5 + 9.21111111111111*x^6 + 20.10125*x^7 + 14.631944444444445*x^8 + 17.627777777777776*x^9 + O(x^10))*y^32 + (3.5 + 1.1111111111111112*x^3 + 3.5*x^4 + 0.2*x^5 + 6.0*x^6 + 3.0*x^7 + 4.0*x^8 + 3.066666666666667*x^9 + O(x^10))*y^31 + (7.333333333333333 + 0.23809523809523808*x^3 + 0.75*x^4 + 0.04285714285714286*x^5 + 1.2857142857142858*x^6 + 0.6428571428571429*x^7 + 2.0238095238095237*x^8 + 10.947619047619048*x^9 + O(x^10))*y^30 + (1.2166666666666666 + 0.8333333333333334*x^3 + 7.0*x^4 + 6.275*x^5 + 6.3*x^6 + 13.7*x^7 + 7.111111111111111*x^8 + 5.941666666666666*x^9 + O(x^10))*y^29 + (3.933333333333333 + 0.5555555555555556*x^3 + 2.1666666666666665*x^4 + 0.6833333333333333*x^5 + 6.6*x^6 + 19.733333333333334*x^7 + 9.114285714285714*x^8 + 4.314444444444445*x^9 + O(x^10))*y^28 + (1.8533333333333333 + 1.6666666666666667*x^3 + 6.166666666666667*x^4 + 7.892857142857143*x^5 + 25.92936507936508*x^6 + 10.79*x^7 + 35.19285714285714*x^8 + 22.60218253968254*x^9 + O(x^10))*y^27 + (4.566666666666666 + 4.175925925925926*x^3 + 2.2708333333333335*x^4 + 10.052380952380952*x^5 + 36.2*x^6 + 21.85*x^7 + 10.333333333333334*x^8 + 7.3694444444444445*x^9 + O(x^10))*y^26 + (17.8 + 0.6666666666666666*x^3 + 4.208333333333333*x^4 + 18.85595238095238*x^5 + 6.18*x^6 + 16.383333333333333*x^7 + 11.492063492063492*x^8 + 14.015145502645503*x^9 + O(x^10))*y^25 + (11.606666666666667 + 0.9740740740740741*x^3 + 3.308333333333333*x^4 + 2.342857142857143*x^5 + 7.04*x^6 + 9.686666666666667*x^7 + 9.754497354497355*x^8 + 35.66481481481482*x^9 + O(x^10))*y^24 + (12.525 + 17.5*x + 2.45*x^2 + 4.358796296296297*x^3 + 7.5625*x^4 + 13.920833333333333*x^5 + 16.75*x^6 + 57.836728395061726*x^7 + 25.926984126984127*x^8 + 24.913888888888888*x^9 + O(x^10))*y^23 + (17.094444444444445 + 2.6666666666666665*x + 2.2333333333333334*x^2 + 3.397222222222222*x^3 + 4.673611111111111*x^4 + 5.649404761904762*x^5 + 22.42064814814815*x^6 + 35.56388888888889*x^7 + 23.999867724867723*x^8 + 35.661904761904765*x^9 + O(x^10))*y^22 + (18.633333333333333 + 3.0*x + 4.14*x^2 + 4.775*x^3 + 10.3*x^4 + 5.8658730158730155*x^5 + 41.41*x^6 + 48.06666666666667*x^7 + 86.54730158730159*x^8 + 53.16497354497354*x^9 + O(x^10))*y^21 + (12.43452380952381 + 0.1*x + 0.2*x^2 + 3.630925925925926*x^3 + 16.635416666666668*x^4 + 43.05952380952381*x^5 + 41.93333333333333*x^6 + 58.583333333333336*x^7 + 32.777486772486775*x^8 + 21.639761904761905*x^9 + O(x^10))*y^20 + (22.645714285714284 + 8.5*x + 3.05*x^2 + 2.890277777777778*x^3 + 10.875*x^4 + 11.036111111111111*x^5 + 18.46904761904762*x^6 + 31.627142857142857*x^7 + 32.39484126984127*x^8 + 34.62608465608466*x^9 + O(x^10))*y^19 + (20.943055555555556 + 7.533333333333333*x + 31.966666666666665*x^2 + 2.25*x^3 + 2.8493055555555555*x^4 + 23.819742063492065*x^5 + 61.55*x^6 + 53.3125*x^7 + 77.43486772486773*x^8 + 46.517526455026456*x^9 + O(x^10))*y^18 + (14.951190476190476 + 11.85*x + 4.975*x^2 + 7.426369047619048*x^3 + 8.854166666666666*x^4 + 22.700113378684808*x^5 + 58.13452380952381*x^6 + 55.958730158730155*x^7 + 55.31509259259259*x^8 + 58.310317460317464*x^9 + O(x^10))*y^17 + (30.016825396825396 + 7.573333333333333*x + 10.266666666666667*x^2 + 3.9285714285714284*x^3 + 3.656547619047619*x^4 + 6.248412698412698*x^5 + 11.476190476190476*x^6 + 48.24142857142857*x^7 + 58.64365079365079*x^8 + 108.16488095238095*x^9 + O(x^10))*y^16 + (16.972619047619048 + 6.0*x + 2.7*x^2 + 2.1125*x^3 + 2.8739583333333334*x^4 + 13.474801587301588*x^5 + 16.966666666666665*x^6 + 25.6015873015873*x^7 + 27.59371693121693*x^8 + 25.497420634920633*x^9 + O(x^10))*y^15 + (31.638492063492063 + 26.633333333333333*x + 26.316666666666666*x^2 + 16.71845238095238*x^3 + 27.275*x^4 + 35.979312169312166*x^5 + 31.415873015873014*x^6 + 53.00265873015873*x^7 + 51.08151927437642*x^8 + 48.26150793650794*x^9 + O(x^10))*y^14 + (20.081349206349206 + 7.675*x + 14.445*x^2 + 11.116071428571429*x^3 + 11.703703703703704*x^4 + 29.096031746031745*x^5 + 32.645833333333336*x^6 + 157.49412698412698*x^7 + 61.75813492063492*x^8 + 106.3288492063492*x^9 + O(x^10))*y^13 + (27.581349206349206 + 5.420238095238095*x + 21.786309523809525*x^2 + 1.8812996031746032*x^3 + 11.323809523809524*x^4 + 26.37850529100529*x^5 + 42.0875*x^6 + 69.0093253968254*x^7 + 57.825132275132276*x^8 + 65.27162698412698*x^9 + O(x^10))*y^12 + (20.617857142857144 + 2.55*x + 9.25*x^2 + 1.8285714285714285*x^3 + 10.783333333333333*x^4 + 5.979365079365079*x^5 + 12.141666666666667*x^6 + 46.73888888888889*x^7 + 34.46484126984127*x^8 + 37.460992063492064*x^9 + O(x^10))*y^11 + (14.791269841269841 + 2.2*x + 11.0*x^2 + 0.9428571428571428*x^3 + 3.8174603174603177*x^4 + 18.496031746031747*x^5 + 15.554960317460317*x^6 + 55.05357142857143*x^7 + 47.25595238095238*x^8 + 27.158730158730158*x^9 + O(x^10))*y^10 + (21.051388888888887 + 10.275*x + 49.575*x^2 + 18.442857142857143*x^3 + 31.482486772486773*x^4 + 33.128571428571426*x^5 + 27.555357142857144*x^6 + 67.53095238095239*x^7 + 50.68022486772487*x^8 + 41.56089285714286*x^9 + O(x^10))*y^9 + (14.730555555555556 + 1.12*x + 2.066666666666667*x^2 + 1.9253968253968254*x^3 + 6.222222222222222*x^4 + 20.289021164021165*x^5 + 20.025*x^6 + 38.980555555555554*x^7 + 52.519444444444446*x^8 + 45.784126984126985*x^9 + O(x^10))*y^8 + (13.697222222222223 + 3.7625*x + 7.1875*x^2 + 6.453571428571428*x^3 + 18.90740740740741*x^4 + 42.99920634920635*x^5 + 58.68125*x^6 + 73.97619047619048*x^7 + 54.194742063492065*x^8 + 37.65813492063492*x^9 + O(x^10))*y^7 + (19.22361111111111 + 2.1666666666666665*x + 3.5*x^2 + 2.8444444444444446*x^3 + 3.75*x^4 + 18.87037037037037*x^5 + 3.0833333333333335*x^6 + 32.888888888888886*x^7 + 19.626851851851853*x^8 + 31.47222222222222*x^9 + O(x^10))*y^6 + (18.2375 + 3.5833333333333335*x + 5.916666666666667*x^2 + 4.533333333333333*x^3 + 5.694444444444445*x^4 + 22.212962962962962*x^5 + 9.88888888888889*x^6 + 51.977777777777774*x^7 + 33.03148148148148*x^8 + 31.968672839506173*x^9 + O(x^10))*y^5 + (10.344444444444445 + 6.625*x + 8.875*x^2 + 16.55*x^3 + 17.511111111111113*x^4 + 11.473148148148148*x^5 + 14.745833333333334*x^6 + 57.175*x^7 + 26.425462962962964*x^8 + 51.65277777777778*x^9 + O(x^10))*y^4 + (20.641666666666666 + 4.125*x + 8.125*x^2 + 3.466666666666667*x^3 + 13.975*x^4 + 4.980092592592593*x^5 + 8.219444444444445*x^6 + 13.9375*x^7 + 12.709259259259259*x^8 + 28.627160493827162*x^9 + O(x^10))*y^3 + (8.275 + 2.1354166666666665*x + 3.8020833333333335*x^2 + 2.3333333333333335*x^3 + 6.263888888888889*x^4 + 7.12037037037037*x^5 + 10.59201388888889*x^6 + 54.25*x^7 + 37.5306712962963*x^8 + 31.43888888888889*x^9 + O(x^10))*y^2 + (1.6666666666666667 + 18.0*x^4 + 1.7777777777777777*x^5 + 13.35*x^6 + 4.7*x^7 + 4.344444444444444*x^8 + 0.5805555555555556*x^9 + O(x^10))*y + 0.625 + 7.5*x^4 + 0.7407407407407407*x^5 + 5.618055555555555*x^6 + 4.291666666666667*x^7 + 0.7476851851851852*x^8 + 0.09375*x^9 + O(x^10)
g = (3.5 + O(x^10))*y^11 + (0.3333333333333333 + O(x^10))*y^10 + (0.2 + O(x^10))*y^9 + (1.5 + O(x^10))*y^7 + (0.6666666666666666 + O(x^10))*y^6 + (2.25 + O(x^10))*y^5 + (0.6666666666666666 + O(x^10))*y^4 + y^3 + (4.5 + O(x^10))*y^2 + (0.1 + O(x^10))*y + 0.375 + O(x^10)
h = y^20 + (2.0 + O(x^10))*y^19 + (0.1 + O(x^10))*y^18 + y^17 + (0.2 + O(x^10))*y^15 + (4.0 + O(x^10))*y^14 + y^13 + (2.3333333333333335 + O(x^10))*y^12 + (2.0 + O(x^10))*y^11 + (0.42857142857142855 + O(x^10))*y^10 + (1.5 + O(x^10))*y^9 + y^8 + (3.0 + O(x^10))*y^7 + (0.16666666666666666 + O(x^10))*y^6 + (0.5 + O(x^10))*y^5 + (1.3333333333333333 + O(x^10))*y^4 + (2.3333333333333335 + O(x^10))*y^3 + y^2 + (4.0 + O(x^10))*y + 1.6666666666666667 + O(x^10)
s = (0.24655887808047638 + O(x^10))*y^19 + (0.3988493172274596 + O(x^10))*y^18 + (-0.1615153083608837 + O(x^10))*y^17 + (0.24156168675002304 + O(x^10))*y^16 + (-0.08474350964126857 + O(x^10))*y^15 + (0.07176014476474553 + O(x^10))*y^14 + (0.9684828455707594 + O(x^10))*y^13 + (-0.13215133012332841 + O(x^10))*y^12 + (0.48860784980120103 + O(x^10))*y^11 + (0.3136681620156455 + O(x^10))*y^10 + (-0.062267738799181876 + O(x^10))*y^9 + (0.32541229414504613 + O(x^10))*y^8 + (0.07968775975586961 + O(x^10))*y^7 + (0.6161949132529052 + O(x^10))*y^6 + (-0.20794268182797196 + O(x^10))*y^5 + (0.11025258362582488 + O(x^10))*y^4 + (0.3103728493316241 + O(x^10))*y^3 + (0.4296693425656534 + O(x^10))*y^2 + (-0.0028944323599857376 + O(x^10))*y + 0.8800236582857225 + O(x^10)
t = (-0.8629560732816673 + O(x^10))*y^10 + (0.247753243573734 + O(x^10))*y^9 + (-0.026168848581456666 + O(x^10))*y^8 + (0.01912111513692923 + O(x^10))*y^7 + (-0.40483212294355225 + O(x^10))*y^6 + (-0.027359371096496346 + O(x^10))*y^5 + (-0.49669088002003087 + O(x^10))*y^4 + (0.0870274930515198 + O(x^10))*y^3 + (-0.2731128674580958 + O(x^10))*y^2 + (-1.0169373967418565 + O(x^10))*y + 0.40199467688571244 + O(x^10)


fast_hensel_lifting(F,g,h,s,t,l)

val_hensel_lifting(F,g,h,s,t,l, 0.0, 1.0)